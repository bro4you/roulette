<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–†–æ–∑—ã–≥—Ä—ã—à</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --gold: #FFD700; --gold2: #FFA500;
  --dark: #08080f; --card: #111118; --border: #222230;
  --text: #e0e0f0; --muted: #555566;
}
body {
  background: var(--dark); color: var(--text);
  font-family: 'Inter', sans-serif;
  min-height: 100vh; display: flex; flex-direction: column;
  align-items: center; overflow-x: hidden; padding-bottom: 24px;
}
body::before {
  content: ''; position: fixed; inset: 0; pointer-events: none;
  background: radial-gradient(ellipse at 70% 10%, rgba(255,215,0,0.05) 0%, transparent 55%),
              radial-gradient(ellipse at 10% 90%, rgba(120,60,255,0.04) 0%, transparent 50%);
}

.screen {
  position: fixed; inset: 0; display: flex; flex-direction: column;
  align-items: center; justify-content: center; padding: 20px;
  z-index: 10; transition: opacity 0.3s, transform 0.3s; overflow-y: auto;
}
.screen.hidden { opacity: 0; pointer-events: none; transform: scale(0.97); }

#rulesScreen { background: var(--dark); }
.rules-logo { font-size: 36px; margin-bottom: 10px; }
.rules-title {
  font-family: 'Unbounded', sans-serif; font-size: 15px; font-weight: 700;
  color: var(--gold); text-align: center; margin-bottom: 16px;
}
.rules-box {
  background: var(--card); border: 1px solid var(--border); border-radius: 14px;
  padding: 16px 18px; width: 100%; max-width: 400px; font-size: 12.5px;
  line-height: 1.7; color: #aaa; margin-bottom: 14px;
  max-height: 52vh; overflow-y: auto;
}
.rules-box b { color: var(--text); }
.rules-box .section { margin-top: 10px; font-weight: 600; color: var(--text); font-size: 12px; }
.rules-box .section:first-child { margin-top: 0; }

.btn-primary {
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  border: none; border-radius: 14px; padding: 15px 28px;
  font-family: 'Unbounded', sans-serif; font-size: 12px; font-weight: 700;
  color: #000; cursor: pointer; width: 100%; max-width: 400px;
}

#wheelScreen {
  background: var(--dark); justify-content: flex-start;
  padding-top: 16px; overflow-y: auto; position: fixed;
}
.wh-title {
  font-family: 'Unbounded', sans-serif;
  font-size: clamp(14px, 4vw, 20px); font-weight: 900;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  margin-bottom: 3px; text-align: center;
}
.wh-sub { font-size: 11px; color: var(--muted); margin-bottom: 16px; text-align: center; }

.wheel-wrapper {
  position: relative;
  width: min(290px, 80vw); height: min(290px, 80vw);
  margin: 0 auto 16px; flex-shrink: 0;
}
.wheel-pointer {
  position: absolute; top: -14px; left: 50%; transform: translateX(-50%);
  width: 0; height: 0;
  border-left: 10px solid transparent; border-right: 10px solid transparent;
  border-top: 20px solid var(--gold); z-index: 10;
}
canvas {
  border-radius: 50%;
  box-shadow: 0 0 0 3px var(--border), 0 0 32px rgba(255,215,0,0.1);
  display: block;
}
.center-hub {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
  width: 50px; height: 50px; border-radius: 50%;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  display: flex; align-items: center; justify-content: center;
  font-family: 'Unbounded', sans-serif; font-size: 8px; font-weight: 700;
  color: #000; cursor: pointer; border: none; z-index: 5;
}
.result-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 14px; padding: 16px 20px; text-align: center;
  width: 100%; max-width: 290px; flex-shrink: 0;
}
.result-text { font-family: 'Unbounded', sans-serif; font-size: 14px; font-weight: 700; color: var(--gold); }
.btn-claim {
  display: none; margin-top: 12px;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  border: none; border-radius: 14px; padding: 14px 24px;
  font-family: 'Unbounded', sans-serif; font-size: 11px; font-weight: 700;
  color: #000; cursor: pointer; width: 100%; max-width: 290px;
}
</style>
</head>
<body>

<div class="screen" id="rulesScreen">
  <div class="rules-logo">üé∞</div>
  <div class="rules-title">–ü—Ä–∞–≤–∏–ª–∞ —É—á–∞—Å—Ç–∏—è</div>
  <div class="rules-box">
    ‚Ä¢ –£—á–∞—Å—Ç–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ<br>
    ‚Ä¢ 1 —É—á–∞—Å—Ç–∏–µ –Ω–∞ 1 –∞–∫–∫–∞—É–Ω—Ç —Ä–∞–∑ –≤ 14 –¥–Ω–µ–π<br>
    ‚Ä¢ –ë–æ–Ω—É—Å –¥–µ–π—Å—Ç–≤—É–µ—Ç 7 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–∞<br>
    ‚Ä¢ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª<br><br>
    ‚è± –°—Ä–æ–∫ –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–∞ ‚Äî –¥–æ 14 –¥–Ω–µ–π.
  </div>
  <button class="btn-primary" onclick="agreeAndPlay()">‚úÖ –ü—Ä–∏–Ω–∏–º–∞—é –∏ —É—á–∞—Å—Ç–≤—É—é</button>
</div>

<div class="screen hidden" id="wheelScreen">
  <div class="wh-title">üé∞ –†–æ–∑—ã–≥—Ä—ã—à</div>
  <p class="wh-sub">–ö—Ä—É—Ç–∏ –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å!</p>

  <div class="wheel-wrapper">
    <div class="wheel-pointer"></div>
    <canvas id="wheel" width="290" height="290"></canvas>
    <button class="center-hub" id="spinBtn" onclick="spin()">–ö–†–£–¢–ò!</button>
  </div>

  <div class="result-card">
    <div class="result-text" id="resultText">–ñ–º–∏ –∫–Ω–æ–ø–∫—É!</div>
  </div>

  <button class="btn-claim" id="claimBtn" onclick="claimPrize()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
const tg = window.Telegram?.WebApp;
if (tg) { tg.ready(); tg.expand(); }

const PRIZES = [
  { label: "1 –æ—Ç–∑—ã–≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ", weight: 5 },
  { label: "–°–∫–∏–¥–∫–∞ 30% –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –Ø–Ω–¥–µ–∫—Å", weight: 15 },
  { label: "15% –Ω–∞ —Å–∞–π—Ç 16 –±–ª–æ–∫–æ–≤", weight: 15 },
  { label: "20% –Ω–∞ —Å–∞–π—Ç 9 –±–ª–æ–∫–æ–≤", weight: 15 },
  { label: "15% –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ê–≤–∏—Ç–æ", weight: 20 },
  { label: "15% –Ω–∞ –≥–æ—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç –ü—Ä–æ—Ñ–∏", weight: 5 },
  { label: "–ü—É—Å—Ç–æ–π –∞–∫–∫–∞—É–Ω—Ç –Ø–Ω–¥–µ–∫—Å –≤ –ø–æ–¥–∞—Ä–æ–∫", weight: 10 },
  { label: "+14 –¥–Ω–µ–π –≥–∞—Ä–∞–Ω—Ç–∏–∏ –Ω–∞ –Ø–Ω–¥–µ–∫—Å", weight: 20 }
];

function weightedRandom() {
  const total = PRIZES.reduce((s,p)=>s+p.weight,0);
  let r = Math.random()*total;
  for (let p of PRIZES){
    r -= p.weight;
    if(r<=0) return p;
  }
}

function spin(){
  const prize = weightedRandom();
  document.getElementById("resultText").innerText = prize.label;
  document.getElementById("claimBtn").style.display = "block";

  if (tg && tg.sendData) {
    tg.sendData(JSON.stringify({ prize: prize.label }));
  }
}

function claimPrize(){
  if (tg) tg.close();
}

function agreeAndPlay(){
  document.getElementById("rulesScreen").classList.add("hidden");
  document.getElementById("wheelScreen").classList.remove("hidden");
}
</script>

</body>
</html>
